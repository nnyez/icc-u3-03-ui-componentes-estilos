import{a as O}from"./chunk-45X2IWRU.js";import{f as D,k as G,o as U,r as V}from"./chunk-7T4TD45U.js";import{a as I,b as c,c as L,d as j,e as q,f as z,g as A,h as B,i as H}from"./chunk-TNZN56QU.js";import{g as M,h as N,k as T,n as k}from"./chunk-QOGA6DDO.js";import{j as R}from"./chunk-YWZJFH4M.js";import{Ab as s,Bb as y,Cb as h,Fa as a,Ob as E,Ua as P,_ as p,db as m,eb as d,fa as C,ga as F,ib as x,jb as o,kb as n,lb as u,na as b,q as _,rb as S,tb as g,yb as w}from"./chunk-AKAGUU27.js";function J(i,r){if(i&1&&(o(0,"div",9),C(),o(1,"svg",24),u(2,"path",25),n(),F(),o(3,"span"),s(4),n()()),i&2){let t=g();a(4),y(t.errorMessage())}}function K(i,r){if(i&1&&(o(0,"span",15),s(1),n()),i&2){let t=g();a(),h(" ",t.formUtils.getFieldError(t.registerForm,"email")," ")}}function Q(i,r){if(i&1&&(o(0,"span",15),s(1),n()),i&2){let t=g();a(),h(" ",t.formUtils.getFieldError(t.registerForm,"password")," ")}}function W(i,r){if(i&1&&(o(0,"span",15),s(1),n()),i&2){let t=g();a(),h(" ",t.formUtils.getFieldError(t.registerForm,"confirmPassword")," ")}}function X(i,r){i&1&&(u(0,"span",26),s(1," Creando cuenta... "))}function Z(i,r){i&1&&s(0," Crear Cuenta ")}var Y=class i{fb=p(B);error=b(null);authService=p(V);firestore=p(D);router=p(M);registerForm;registerTrigger=b(null);registerResource=k({params:()=>this.registerTrigger(),stream:({params:r})=>r?this.authService.register(r.email,r.password):_(null)});loading=this.registerResource.isLoading;formUtils=O;constructor(){this.registerForm=this.fb.group({email:["",[c.required,c.email]],password:["",[c.required,c.minLength(6)]],confirmPassword:["",[c.required]]},{validators:this.passwordMatchValidator}),E(()=>{this.registerResource.hasValue()&&this.registerResource.value()&&this.router.navigate(["/home"])})}passwordMatchValidator(r){let t=r.get("password"),e=r.get("confirmPassword");return t&&e&&t.value!==e.value?(e.setErrors({passwordMismatch:!0}),{passwordMismatch:!0}):null}onSubmit(){let{email:r,password:t}=this.registerForm.value;this.authService.register(r,t).subscribe({next:async e=>{let l={uid:e.user.uid,email:e.user.email,role:"user",displayName:e.user.displayName||""};await U(G(this.firestore,"users",e.user.uid),l),this.router.navigate(["/home"])},error:e=>{this.errorMessage()}})}errorMessage=()=>{let r=this.registerResource.error();if(!r)return"";let t=r.code||"";return{"auth/email-already-in-use":"Este correo ya esta registrado","auth/invalid-email":"El correo no es valido","auth/operation-not-allowed":"Operacion no permitida","auth/weak-password":"La contrasena es debil"}[t]??"No pudimos crear la cuenta"};get email(){return this.registerForm.get("email")}get password(){return this.registerForm.get("password")}get confirmPassword(){return this.registerForm.get("confirmPassword")}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=P({type:i,selectors:[["app-register-page"]],decls:41,vars:13,consts:[[1,"min-h-screen","flex","items-center","justify-center","bg-linear-to-br","from-secondary","to-accent","p-4"],[1,"card","w-full","max-w-md","bg-base-100","shadow-2xl","animate-fade-in"],[1,"card-body"],[1,"text-center","mb-6"],[1,"avatar","placeholder","mb-4"],[1,"bg-secondary","text-secondary-content","rounded-full","w-20"],[1,"text-4xl"],[1,"text-3xl","font-bold","text-secondary","mb-2"],[1,"text-base-content/70"],[1,"alert","alert-error","mb-4"],[3,"ngSubmit","formGroup"],[1,"form-control"],[1,"label"],[1,"label-text"],["type","email","formControlName","email","placeholder","ejemplo@correo.com",1,"input","input-bordered","w-full"],[1,"block","text-red-500","text-sm","mt-1"],[1,"form-control","mt-4"],["type","password","formControlName","password","placeholder","********",1,"input","input-bordered","w-full"],["type","password","formControlName","confirmPassword","placeholder","********",1,"input","input-bordered","w-full"],[1,"form-control","mt-6"],["type","submit",1,"btn","btn-secondary","w-full",3,"disabled"],[1,"text-center","mt-4"],[1,"text-sm","text-base-content/70"],["routerLink","/login",1,"link","link-secondary","font-semibold"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"stroke-current","shrink-0","h-6","w-6"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"loading","loading-spinner","loading-sm"]],template:function(t,e){if(t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"span",6),s(7,"\u2728"),n()()(),o(8,"h1",7),s(9,"Crear Cuenta"),n(),o(10,"p",8),s(11,"Reg\xEDstrate para comenzar"),n()(),m(12,J,5,1,"div",9),o(13,"form",10),S("ngSubmit",function(){return e.onSubmit()}),o(14,"div",11)(15,"label",12)(16,"span",13),s(17,"Correo electronico"),n()(),u(18,"input",14),m(19,K,2,1,"span",15),n(),o(20,"div",16)(21,"label",12)(22,"span",13),s(23,"Contrasena"),n()(),u(24,"input",17),m(25,Q,2,1,"span",15),n(),o(26,"div",16)(27,"label",12)(28,"span",13),s(29,"Confirmar Contrasena"),n()(),u(30,"input",18),m(31,W,2,1,"span",15),n(),o(32,"div",19)(33,"button",20),m(34,X,2,0)(35,Z,1,0),n()()(),o(36,"div",21)(37,"p",22),s(38," Ya tienes cuenta? "),o(39,"a",23),s(40," Inicia sesion aqui "),n()()()()()()),t&2){let l,f,v;a(12),d(e.registerResource.error()?12:-1),a(),x("formGroup",e.registerForm),a(5),w("input-error",(e.email==null?null:e.email.invalid)&&(e.email==null?null:e.email.touched)),a(),d((l=e.registerForm.get("email"))!=null&&l.invalid&&((l=e.registerForm.get("email"))!=null&&l.touched)?19:-1),a(5),w("input-error",(e.password==null?null:e.password.invalid)&&(e.password==null?null:e.password.touched)),a(),d((f=e.registerForm.get("password"))!=null&&f.invalid&&((f=e.registerForm.get("password"))!=null&&f.touched)?25:-1),a(5),w("input-error",(e.confirmPassword==null?null:e.confirmPassword.invalid)&&(e.confirmPassword==null?null:e.confirmPassword.touched)),a(),d((v=e.registerForm.get("confirmPassword"))!=null&&v.invalid&&((v=e.registerForm.get("confirmPassword"))!=null&&v.touched)?31:-1),a(2),x("disabled",e.loading()||e.registerForm.invalid),a(),d(e.loading()?34:35)}},dependencies:[R,H,q,I,L,j,z,A,T,N],encapsulation:2})};export{Y as RegisterPage};
